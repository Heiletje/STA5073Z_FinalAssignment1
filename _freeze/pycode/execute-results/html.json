{
  "hash": "3d9fd0cf45c8b9e598b094ec923ce2d0",
  "result": {
    "markdown": "---\ntitle: \"Prediction of Presidents\"\ntitle-size: small\nformat: html\nexecute:\n  echo: false\n  cache: true\n  freeze: auto\n---\n\n<div style=\"text-align: justify\"> \n\n<h4> Abstract </h4> \n<hr> \nConverging machine learning (ML) and natural language processing (NLP) techniques, a predictive text-analysis was performed on the State of the Nation Addresses (SONAs) delivered by South African presidents spanning the period from 1994 to 2023. Different types of neural networks (NNs) were employed for the purpose of predicting the president from their spoken sentences. \nServing as a foundational-comparative model, a naive classification tree (CT) was first fitted followed by varying-in-complexity models from a simple feed-forward NN (FNN) to more sophisticated NNs, such as recurrent (RNN) and convolutional (CNN). For each predictive model, the involved text was transformed into features via three approaches, namely bag-of-words (BoW), term-frequency, inverse-document-frequency (tf-idf), and embeddings. A comparison, in terms of correct-classification capability, between the numerous NNs across the differently defined features was conducted with the objective of obtaining the optimal predictive model for the political speeches. \n\n\n<h4> Introduction </h4> \n<hr> \nThe domains of machine learning (ML) and natural language processing (NLP) intersect at text-based analysis involving the underlying aim of prediction. In this instance, the text of interest to analyze are the annual State of the Nation Address (SONA) speeches (from 1994 to 2023), whilst the predictive objective is pointed at determining which one of the six different South African presidents (F.W. de Klerk, N.R. Mandela, T.M. Mbeki, K.P. Motlanthe, J.G. Zuma, and M.C. Ramaphosa) delivered some sentence contained therein. \n\nIn order to achieve this predictive analysis, diverse ML models with differing degrees of complexity are applied. First, in order to form a comparative basis for performance, a naïve classification tree is fitted. This is then followed with the implementation of three types of neural networks (NNs),each with ascending degrees of sophistication, specifically a simple one (feed-forward) and then more complex ones (recurrent and convolutional).\n\n\n\n<h4> Literature Review </h4> \n<hr> \n\n<b><u> SONA  </b></u>\n\nSONA, a pivotal event in the political programme of Parliament, serves as a presidential summary for the South African public. Specifically, the country’s current domestic affairs and international relations are reflected upon, past governmental work is perused, and future plans in terms of policies and civil projects are proposed. Through this address, accountability on the part of government is re-instilled and transparency with the public is re-affirmed on an annual basis, either once (non-election year) or twice (pre-and-post election) [@Muthambi2017].\n\n<h4> Data </h4>\n<hr>\n\n\n<b><u> Tokenization </b></u>\n\nThe process of tokenization entails breaking up given text into units, referred to as tokens (or terms), which are meaningful for analysis [@Zhang2018]. In this case, these tokens take on different structures, based on either a macro-context (i.e., sentences) or micro-context (i.e., words). At both scales, the way in which these tokens are valued will be varied. The value will either be defined by a bag-of-words (BoW) or term-frequency, inverse-document-frequency (tf-idf) approach. The former way implicates accounting for the number of occurrences of some token in some document. On the other hand, the latter way not only regards the frequency of some token, but also the significance thereof. Thus, tf-idf involves the assignment of some weight to each token in a document which in turn reflects its importance relative to the entire collection of documents (corpus). It then follows that the tf-idf value of a token *t* in a document *d* within a corpus *D* is calculated as the product of two constituents. The first being tf(*t*,*d*) defined as the quotient of the frequency of token *t* in document *d* and the total number of tokens in document *d*, whereas the second is idf(*t*, *D*) denoted by the quotient of the natural logarithm of the total number of documents in corpus *D* and the number of documents containing the token *t* [@SilgeRobinson2017]. \n\n\n<b><u> Pre-processing </b></u>\n\n\n<h4> Methods </h4>\n<hr>\n\n<b><u> Classification Tree (CT) </b></u>\n\n\n![Schematic representation of an exemplary CT.](CT.png){height=300 #fig-CT}\n\nA classification tree (CT) [@Breiman1984] is a straightforward ML technique predominately applied in categorical prediction contexts. This simple model operates on the principle of segmenting some data into subsets, where these partitions are based on distinct values of individual features. It is naïve in its approach given it considers each feature in isolation in order to make classifying decisions, hence often overlooking complex feature interactions. \n\nWhen applied to text-based data, a CT makes classification decisions based on either the frequency (a BoW representation) or weighted frequency of words (a tf-idf representation) as the features. As illustrated in @fig-CT, each CT decision node (shown as a grey, rectangular block) represents a rule where some threshold on a particular word's frequency (or weighted version thereof) is defined. While less conventional, word embeddings can also be utilized instead. Though, the CT is often found to be mediocre in its ability to fully exploit the rich semantic and syntactic relationships captured in embeddings. Given that embeddings provide a dense representation of words in a high-dimensional space, the simplistic decision boundaries of a CT are sub-par in capturing the associated contextual nuances [@Charbuty2021]. \n\nCT hyperparameters comprise of the minimum number of samples required to split a node  as well as the maximum tree depth. Using a grid-search approach coupled with a *k*-fold cross-validation (CV) process, various combinations of these two hyperparameters over smaller sets of data (folds) are systematically assessed to find a configuration where a chosen performance metric is optimized. Here, such a metric is the average of evaluation scores (like accuracy) obtained across all folds for the hyperparameter set yielding the highest value thereof.\n\nCTs are superior in terms of its simplistic interpretability and visualization, though this advantage is tainted with its proneness to overfitting (with deep trees) and inability to capture feature complexity.  \n\n<b><u> Feed-forward Neural Network (NN) </b></u>\n\n![Schematic representation of an exemplary FNN](FNN.png){height=500 width=500 #fig-FNN}\n\nA feed-forward Neural Network (FNN) is a type of artificial NN wherein connections between the nodes (neurons) do not form a cycle (uni-directional in nature). As depicted in @fig-FNN, this architecture is characterized by its stratified structure,  comprising of an input layer (grey circles), one or more hidden layers (white circles), and an output layer (black circles). In each layer, the nodes apply weights and biases to inputs before passing through an activation function.\n\nIn text analysis, when using BoW or tf-idf representations, each word is represented as a feature (i.e., a unique input neuron). FNNs transform text-based data into numerical vectors where each dimension corresponds to a word frequency (or weighted version thereof). These vectors are efficiently processed, thereby enabling the network to learn patterns that are predictive of an outcome of interest (like predicting presidents from sentences). With  the employment of embeddings, unlike CTs, FNNs are able to leverage such dense word representations to capture subtler semantic patterns, potentially leading to more enhanced predictions. \n\nFNN hyperparameters involve the number of hidden layers, the number of neurons in each hidden layer, the type of activation function (e.g., ReLU or tanh), and the learning rate. To identify the optimal network architecture, a grid search over these tuneable parameters is executed. \n\nIn contrast to CTs, FNNs possess a higher aptitude to deal with feature intricacies, whether there is high dimensionality or the presence of non-linear relationships. Despite this, FNNs are also still susceptible to overfitting (with many layers/nodes). Additionally, despite its ability to capture semantic information, this is hindered by its inherent incapacity to simultaneously encapsulate the sequential/temporal relationship prevalent in text. \n\n\n<b><u> Convolutional Neural Network (CNN) </b></u>\n\n\n![Schematic representation of an exemplary CNN.](CNN.png){#fig-CNN}\n\nConvolutional Neural Networks (CNNs), primarily applied within the field of image-processing, have also proven proficiency in processing natural language processing (NLP) tasks. CNNs are designed to adaptively learn spatial hierarchies of features from input data. In the context of text, this means the model is able to learn any recognizable patterns or sequences of words which carry significant semantic meaning.\n\nIn comparison to CTs and FNNS, CNNs are the most specialized to incorporate embeddings, exploiting the associated representation to capture contextual information. The convolutional layers (as shown in @fig-CNN) are able to detect local patterns (like phrases or commonly co-occurring words) within these embeddings. With this model, the BoW and tf-idf approach is not ordinarily applied, given that both these representations lack the inherent sequential nature of text. Thus, the ability of CNNs to capture local dependencies is limited. \n\nCNN hyperparameters consist of the number convolutional layers, the size and number of filters (kernels), the size of the pooling layers, and the dropout rate. To configure the optimal set of these tunable parameters, a grid search approach is applied. \n\nCNNs are able to capture local dependencies in text-based data, allowing for more apt short-length pattern recognition. However, when dealing with long-range dependencies (like with sentences), the performance of CNNs is dampened. Lastly, given the implicit shared-weight architecture of the model, the tendency to overfit is not as prevalent compared to CTs and FNNS. \n\n\n<b><u> Recurrent Neural Network (RNN) </b></u>\n\n\n![Schematic representation of an exemplary RNN](RNN.png){height=200 width=450 #fig-RNN}\n\nRecurrent Neural Networks (RNNs) are designed to handle sequential data. This model shares a similar architecture to FNNs, as represented in @fig-RNN, with an exception of two differences. FNNs are uni-directional models, whilst RNNs are bi-directional in nature. For the latter model, this means that information from some nodes’ outputs are able to flow in a backward direction (represented as red arrows), affecting subsequent input to the same node. Moreover, RNNs share the same weight parameter within each layer unlike FNNs where different weights apply across each node.\n\nIn the context of text, this means RNNs are well-suited for tasks where understanding the order and context of words is paramount. Unlike FNNs, RNNs utilize internal state (memory) to process sequences of inputs, therefore allowing information across different parts of the text to be maintained. \n\nLike with CNNs, RNNs are more effective when employing embeddings in comparison to BoW or tf-idf representations. These latter two approaches do not preserve the sequential order of words, which is the key feature RNNs endeavour to exploit. Through embeddings, the model is able to understand context such as comprehending how the meaning of a word is contingent on its position. This is particularly pertinent in text-based analysis involving sentence structures. \n\nRNN hyperparameters, which can be optimized to values allowing for the best predictive model performance via a grid-search approach,  include number of recurrent units and the size thereof, dropout rates, and types of recurrent layers. \n\nConversely to CNNs, RNNs are more capable of dealing with long-range dependencies prevalent in text-based data, given it implicitly depends on the existence of some sort of sequential element.  Despite this, these models are rather difficult to train given exploding gradients (especially with long sequences like sentences), whilst also being expensive both in terms of \nintensity and time. \n\n<b><u> Model performance metrics </b></u>\n\n::: {.cell execution_count=2}\n\n::: {.cell-output .cell-output-stderr}\n```\n/var/folders/km/sfmlc74j2sqgqqnyck0zzymm0000gn/T/ipykernel_57886/3013898681.py:33: DeprecationWarning:\n\n`import kerastuner` is deprecated, please use `import keras_tuner`.\n\n```\n:::\n:::\n\n\n\n\n<h4> Exploratory Data Analysis </h4> \n<hr> \n\nFigure 1 \n\n\n\n<!-- ![Number of SONA speeches for each president.](EDA/president_num_speeches.png){#fig-president_num_speeches} -->\n\n@fig-president_num_speeches delineates the distribution of speeches across the different presidents, revealing a notable underrepresentation of de Klerk and Motlanthe. This scarcity of speeches, and so a shortage of number of sentences as well, amongst only two out of the six presidents results in an imbalanced corpus. The subsequent training of any ML model on such disproportionate data potentially jeopardizes the overall predictive performance and generalizability thereof.  Consequently, it is strategically chosen to exclude de Klerk and Motlanthe, hence instead focusing the prediction task exclusively on Mbeki, Zuma (with ten speeches each), Mandela and Ramaphosa (with seven speeches each). \n\n\n\n![Number of sentences in SONA speeches for each president.](EDA/president_num_sentences.png){#fig-president_num_sentences}\n\n@fig-president_num_sentences \n\n\n\n<!-- ![Average sentence length in SONA speeches for each president.](EDA/avg_sentence_length.png){#fig-avg_sentence_length} -->\n\n@fig-avg_sentence_length illustrates a notable contrast in the textual characteristics of speeches by Mandela and Zuma. Although Mandela's speeches encompass the fewest sentences, they surprisingly contain the second-highest average word count per sentence. Conversely, Zuma's speeches, while having the highest sentence count, exhibit the shortest average sentence length.\n\n\n\n![Most frequent words stated across all speeches, irrespective of president.](EDA/top_words.png){#fig-top_words}\n@fig-top_words\n\n\n![Most frequent words stated across all speeches, stratified by president.](EDA/top_words_per_president.png){#fig-top_words_per_president}\n@fig-top_words_per_president \n\n\n\n\n\n\n\n::: {.cell execution_count=11}\n\n::: {.cell-output .cell-output-stdout}\n```\nBest parameters (bow): {'max_depth': 7, 'min_samples_split': 10}\n\nClassification Report on Test Set (Classification Tree - bow):\n              precision    recall  f1-score   support\n\n     Mandela       0.33      0.03      0.05       321\n       Mbeki       0.56      0.08      0.15       480\n   Ramaphosa       0.62      0.10      0.17       456\n        Zuma       0.31      0.95      0.47       526\n\n    accuracy                           0.33      1783\n   macro avg       0.46      0.29      0.21      1783\nweighted avg       0.46      0.33      0.23      1783\n\n\nClassification Report on Validation Set (Classification Tree - bow):\n              precision    recall  f1-score   support\n\n     Mandela       0.47      0.04      0.08       321\n       Mbeki       0.55      0.10      0.16       479\n   Ramaphosa       0.53      0.09      0.15       456\n        Zuma       0.32      0.97      0.48       526\n\n    accuracy                           0.34      1782\n   macro avg       0.47      0.30      0.22      1782\nweighted avg       0.46      0.34      0.24      1782\n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-11-output-2.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-11-output-3.png){width=655 height=534}\n:::\n:::\n\n\n::: {.cell execution_count=12}\n\n::: {.cell-output .cell-output-stdout}\n```\nBest parameters (tfidf): {'max_depth': 7, 'min_samples_split': 10}\n\nClassification Report on Test Set (Classification Tree - tfidf):\n              precision    recall  f1-score   support\n\n     Mandela       0.35      0.02      0.04       321\n       Mbeki       0.52      0.09      0.15       480\n   Ramaphosa       0.60      0.10      0.17       456\n        Zuma       0.31      0.95      0.47       526\n\n    accuracy                           0.33      1783\n   macro avg       0.45      0.29      0.20      1783\nweighted avg       0.45      0.33      0.23      1783\n\n\nClassification Report on Validation Set (Classification Tree - tfidf):\n              precision    recall  f1-score   support\n\n     Mandela       0.44      0.04      0.07       321\n       Mbeki       0.57      0.11      0.18       479\n   Ramaphosa       0.54      0.09      0.15       456\n        Zuma       0.32      0.96      0.48       526\n\n    accuracy                           0.34      1782\n   macro avg       0.47      0.30      0.22      1782\nweighted avg       0.46      0.34      0.24      1782\n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-12-output-2.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-12-output-3.png){width=655 height=534}\n:::\n:::\n\n\n::: {.cell execution_count=13}\n\n::: {.cell-output .cell-output-stdout}\n```\nBest parameters (embedding): {'max_depth': 5, 'min_samples_split': 2}\n\nClassification Report on Test Set (Classification Tree - embedding):\n              precision    recall  f1-score   support\n\n     Mandela       0.25      0.01      0.02       321\n       Mbeki       0.28      0.88      0.43       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.33      0.17      0.23       526\n\n    accuracy                           0.29      1783\n   macro avg       0.22      0.27      0.17      1783\nweighted avg       0.22      0.29      0.19      1783\n\n\nClassification Report on Validation Set (Classification Tree - embedding):\n              precision    recall  f1-score   support\n\n     Mandela       0.14      0.00      0.01       321\n       Mbeki       0.28      0.90      0.43       479\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.38      0.18      0.24       526\n\n    accuracy                           0.30      1782\n   macro avg       0.20      0.27      0.17      1782\nweighted avg       0.21      0.30      0.19      1782\n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-13-output-2.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-13-output-3.png){width=665 height=534}\n:::\n:::\n\n\n<!-- ::: {#fig-sent-presidents layout-ncol=2}\n\n![$\\texttt{AFINN}$: de Klerk speeches](sentiment_plots/sent_afinn_deKlerk.png){#fig-sent-deKlerk-afinn}\n\n![$\\texttt{bing}$: de Klerk speeches](sentiment_plots/sent_bing_deKlerk.png){#fig-sent-deKlerk-bing}\n\n::: -->\n\n\n\n::: {.cell execution_count=15}\n\n::: {.cell-output .cell-output-stderr}\n```\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nTraining model with (100,) hidden layers and relu activation\n\r 1/56 [..............................] - ETA: 4s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 303us/step\n\nClassification Report (bow - (100,) - relu):\n              precision    recall  f1-score   support\n\n     Mandela       0.28      0.19      0.23       321\n       Mbeki       0.43      0.36      0.39       480\n   Ramaphosa       0.44      0.40      0.42       456\n        Zuma       0.39      0.56      0.46       526\n\n    accuracy                           0.40      1783\n   macro avg       0.38      0.38      0.37      1783\nweighted avg       0.39      0.40      0.39      1783\n\n\nTraining model with (100,) hidden layers and tanh activation\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 328us/step\n\nClassification Report (bow - (100,) - tanh):\n              precision    recall  f1-score   support\n\n     Mandela       0.34      0.19      0.24       321\n       Mbeki       0.47      0.40      0.43       480\n   Ramaphosa       0.50      0.41      0.45       456\n        Zuma       0.40      0.62      0.49       526\n\n    accuracy                           0.43      1783\n   macro avg       0.43      0.41      0.40      1783\nweighted avg       0.43      0.43      0.42      1783\n\n\nTraining model with (100, 50) hidden layers and relu activation\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 388us/step\n\nClassification Report (bow - (100, 50) - relu):\n              precision    recall  f1-score   support\n\n     Mandela       0.30      0.21      0.24       321\n       Mbeki       0.45      0.41      0.43       480\n   Ramaphosa       0.48      0.40      0.44       456\n        Zuma       0.38      0.53      0.44       526\n\n    accuracy                           0.41      1783\n   macro avg       0.40      0.39      0.39      1783\nweighted avg       0.41      0.41      0.40      1783\n\n\nTraining model with (100, 50) hidden layers and tanh activation\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 381us/step\n\nClassification Report (bow - (100, 50) - tanh):\n              precision    recall  f1-score   support\n\n     Mandela       0.32      0.21      0.26       321\n       Mbeki       0.44      0.38      0.41       480\n   Ramaphosa       0.41      0.37      0.39       456\n        Zuma       0.39      0.55      0.45       526\n\n    accuracy                           0.40      1783\n   macro avg       0.39      0.38      0.38      1783\nweighted avg       0.40      0.40      0.39      1783\n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-15-output-3.png){width=601 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-15-output-4.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-15-output-5.png){width=611 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-15-output-6.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-15-output-7.png){width=601 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-15-output-8.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-15-output-9.png){width=601 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-15-output-10.png){width=572 height=460}\n:::\n:::\n\n\n::: {.cell execution_count=16}\n\n::: {.cell-output .cell-output-stderr}\n```\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nTraining model with (100,) hidden layers and relu activation\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 380us/step\n\nClassification Report (tf-idf - (100,) - relu):\n              precision    recall  f1-score   support\n\n     Mandela       0.32      0.20      0.25       321\n       Mbeki       0.47      0.38      0.42       480\n   Ramaphosa       0.48      0.43      0.45       456\n        Zuma       0.39      0.59      0.47       526\n\n    accuracy                           0.42      1783\n   macro avg       0.42      0.40      0.40      1783\nweighted avg       0.42      0.42      0.41      1783\n\n\nTraining model with (100,) hidden layers and tanh activation\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 344us/step\n\nClassification Report (tf-idf - (100,) - tanh):\n              precision    recall  f1-score   support\n\n     Mandela       0.36      0.18      0.24       321\n       Mbeki       0.47      0.44      0.45       480\n   Ramaphosa       0.46      0.41      0.43       456\n        Zuma       0.39      0.57      0.46       526\n\n    accuracy                           0.42      1783\n   macro avg       0.42      0.40      0.40      1783\nweighted avg       0.42      0.42      0.41      1783\n\n\nTraining model with (100, 50) hidden layers and relu activation\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 397us/step\n\nClassification Report (tf-idf - (100, 50) - relu):\n              precision    recall  f1-score   support\n\n     Mandela       0.31      0.17      0.22       321\n       Mbeki       0.46      0.39      0.42       480\n   Ramaphosa       0.47      0.41      0.44       456\n        Zuma       0.39      0.59      0.47       526\n\n    accuracy                           0.42      1783\n   macro avg       0.41      0.39      0.39      1783\nweighted avg       0.41      0.42      0.40      1783\n\n\nTraining model with (100, 50) hidden layers and tanh activation\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 369us/step\n\nClassification Report (tf-idf - (100, 50) - tanh):\n              precision    recall  f1-score   support\n\n     Mandela       0.29      0.19      0.23       321\n       Mbeki       0.47      0.38      0.42       480\n   Ramaphosa       0.42      0.39      0.41       456\n        Zuma       0.39      0.56      0.46       526\n\n    accuracy                           0.40      1783\n   macro avg       0.39      0.38      0.38      1783\nweighted avg       0.40      0.40      0.39      1783\n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-16-output-3.png){width=601 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-16-output-4.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-16-output-5.png){width=611 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-16-output-6.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-16-output-7.png){width=611 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-16-output-8.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-16-output-9.png){width=601 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-16-output-10.png){width=572 height=460}\n:::\n:::\n\n\n::: {.cell execution_count=17}\n\n::: {.cell-output .cell-output-stderr}\n```\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\nTraining model with (100,) hidden layers and relu activation\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 337us/step\n\nClassification Report (embedding - (100,) - relu):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.33      0.15      0.20       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.30      0.89      0.45       526\n\n    accuracy                           0.30      1783\n   macro avg       0.16      0.26      0.16      1783\nweighted avg       0.18      0.30      0.19      1783\n\n\nTraining model with (100,) hidden layers and tanh activation\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 358us/step\n\nClassification Report (embedding - (100,) - tanh):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.00      0.00      0.00       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.30      1.00      0.46       526\n\n    accuracy                           0.30      1783\n   macro avg       0.07      0.25      0.11      1783\nweighted avg       0.09      0.30      0.13      1783\n\n\nTraining model with (100, 50) hidden layers and relu activation\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 375us/step\n\nClassification Report (embedding - (100, 50) - relu):\n              precision    recall  f1-score   support\n\n     Mandela       0.20      0.00      0.01       321\n       Mbeki       0.31      0.43      0.36       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.30      0.64      0.41       526\n\n    accuracy                           0.30      1783\n   macro avg       0.20      0.27      0.19      1783\nweighted avg       0.21      0.30      0.22      1783\n\n\nTraining model with (100, 50) hidden layers and tanh activation\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 378us/step\n\nClassification Report (embedding - (100, 50) - tanh):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.31      0.51      0.39       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.31      0.58      0.40       526\n\n    accuracy                           0.31      1783\n   macro avg       0.15      0.27      0.20      1783\nweighted avg       0.17      0.31      0.22      1783\n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-17-output-3.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-17-output-4.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-17-output-5.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-17-output-6.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-17-output-7.png){width=632 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-17-output-8.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-17-output-9.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-17-output-10.png){width=572 height=460}\n:::\n:::\n\n\n\n\n::: {.cell execution_count=19}\n\n::: {.cell-output .cell-output-stderr}\n```\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nTraining model with filters=64, kernel_size=3, dropout_rate=0.2\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 528us/step\n\nClassification Report (CNN - BoW - Filters:64 Kernel:3 Dropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.37      0.21      0.27       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.31      0.90      0.46       526\n\n    accuracy                           0.32      1783\n   macro avg       0.17      0.28      0.18      1783\nweighted avg       0.19      0.32      0.21      1783\n\nTraining model with filters=64, kernel_size=3, dropout_rate=0.5\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 531us/step\n\nClassification Report (CNN - BoW - Filters:64 Kernel:3 Dropout:0.5):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.37      0.21      0.27       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.31      0.90      0.46       526\n\n    accuracy                           0.32      1783\n   macro avg       0.17      0.28      0.18      1783\nweighted avg       0.19      0.32      0.21      1783\n\nTraining model with filters=64, kernel_size=5, dropout_rate=0.2\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 538us/step\n\nClassification Report (CNN - BoW - Filters:64 Kernel:5 Dropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.37      0.29      0.32       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.32      0.85      0.46       526\n\n    accuracy                           0.33      1783\n   macro avg       0.17      0.28      0.20      1783\nweighted avg       0.19      0.33      0.22      1783\n\nTraining model with filters=64, kernel_size=5, dropout_rate=0.5\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 594us/step\n\nClassification Report (CNN - BoW - Filters:64 Kernel:5 Dropout:0.5):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.37      0.29      0.32       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.32      0.85      0.46       526\n\n    accuracy                           0.33      1783\n   macro avg       0.17      0.28      0.20      1783\nweighted avg       0.19      0.33      0.22      1783\n\nTraining model with filters=128, kernel_size=3, dropout_rate=0.2\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 774us/step\n\nClassification Report (CNN - BoW - Filters:128 Kernel:3 Dropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.37      0.21      0.27       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.31      0.90      0.46       526\n\n    accuracy                           0.32      1783\n   macro avg       0.17      0.28      0.18      1783\nweighted avg       0.19      0.32      0.21      1783\n\nTraining model with filters=128, kernel_size=3, dropout_rate=0.5\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 725us/step\n\nClassification Report (CNN - BoW - Filters:128 Kernel:3 Dropout:0.5):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.37      0.21      0.27       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.31      0.90      0.46       526\n\n    accuracy                           0.32      1783\n   macro avg       0.17      0.28      0.18      1783\nweighted avg       0.19      0.32      0.21      1783\n\nTraining model with filters=128, kernel_size=5, dropout_rate=0.2\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 775us/step\n\nClassification Report (CNN - BoW - Filters:128 Kernel:5 Dropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.37      0.29      0.32       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.32      0.85      0.46       526\n\n    accuracy                           0.33      1783\n   macro avg       0.17      0.28      0.20      1783\nweighted avg       0.19      0.33      0.22      1783\n\nTraining model with filters=128, kernel_size=5, dropout_rate=0.5\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 750us/step\n\nClassification Report (CNN - BoW - Filters:128 Kernel:5 Dropout:0.5):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.37      0.29      0.32       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.32      0.85      0.46       526\n\n    accuracy                           0.33      1783\n   macro avg       0.17      0.28      0.20      1783\nweighted avg       0.19      0.33      0.22      1783\n\nFilters: 64, Kernel Size: 5, Dropout Rate: 0.5, Best Val Accuracy: 0.3389450013637543\nFilters: 64, Kernel Size: 5, Dropout Rate: 0.2, Best Val Accuracy: 0.33782267570495605\nFilters: 128, Kernel Size: 5, Dropout Rate: 0.2, Best Val Accuracy: 0.33782267570495605\nFilters: 128, Kernel Size: 5, Dropout Rate: 0.5, Best Val Accuracy: 0.33782267570495605\nFilters: 64, Kernel Size: 3, Dropout Rate: 0.2, Best Val Accuracy: 0.33052748441696167\nFilters: 64, Kernel Size: 3, Dropout Rate: 0.5, Best Val Accuracy: 0.33052748441696167\nFilters: 128, Kernel Size: 3, Dropout Rate: 0.2, Best Val Accuracy: 0.33052748441696167\nFilters: 128, Kernel Size: 3, Dropout Rate: 0.5, Best Val Accuracy: 0.33052748441696167\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-3.png){width=632 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-4.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-5.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-6.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-7.png){width=632 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-8.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-9.png){width=632 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-10.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-11.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-12.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-13.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-14.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-15.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-16.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-17.png){width=632 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-19-output-18.png){width=572 height=460}\n:::\n:::\n\n\n::: {.cell execution_count=20}\n\n::: {.cell-output .cell-output-stdout}\n```\nTraining model with filters=64, kernel_size=3, dropout_rate=0.2\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 515us/step\n\nClassification Report (CNN - tf-idf - Filters:64 Kernel:3 Dropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.34      0.51      0.41       480\n   Ramaphosa       1.00      0.00      0.00       456\n        Zuma       0.34      0.68      0.45       526\n\n    accuracy                           0.34      1783\n   macro avg       0.42      0.30      0.22      1783\nweighted avg       0.45      0.34      0.24      1783\n\nTraining model with filters=64, kernel_size=3, dropout_rate=0.5\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 588us/step\n\nClassification Report (CNN - tf-idf - Filters:64 Kernel:3 Dropout:0.5):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.35      0.47      0.40       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.33      0.72      0.46       526\n\n    accuracy                           0.34      1783\n   macro avg       0.17      0.30      0.21      1783\nweighted avg       0.19      0.34      0.24      1783\n\nTraining model with filters=64, kernel_size=5, dropout_rate=0.2\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 542us/step\n\nClassification Report (CNN - tf-idf - Filters:64 Kernel:5 Dropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.34      0.50      0.40       480\n   Ramaphosa       0.50      0.01      0.02       456\n        Zuma       0.33      0.68      0.45       526\n\n    accuracy                           0.34      1783\n   macro avg       0.29      0.30      0.22      1783\nweighted avg       0.32      0.34      0.25      1783\n\nTraining model with filters=64, kernel_size=5, dropout_rate=0.5\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 574us/step\n\nClassification Report (CNN - tf-idf - Filters:64 Kernel:5 Dropout:0.5):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.34      0.50      0.41       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.33      0.69      0.45       526\n\n    accuracy                           0.34      1783\n   macro avg       0.17      0.30      0.21      1783\nweighted avg       0.19      0.34      0.24      1783\n\nTraining model with filters=128, kernel_size=3, dropout_rate=0.2\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 683us/step\n\nClassification Report (CNN - tf-idf - Filters:128 Kernel:3 Dropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.35      0.49      0.41       480\n   Ramaphosa       1.00      0.00      0.00       456\n        Zuma       0.33      0.70      0.45       526\n\n    accuracy                           0.34      1783\n   macro avg       0.42      0.30      0.21      1783\nweighted avg       0.45      0.34      0.24      1783\n\nTraining model with filters=128, kernel_size=3, dropout_rate=0.5\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 642us/step\n\nClassification Report (CNN - tf-idf - Filters:128 Kernel:3 Dropout:0.5):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.34      0.53      0.42       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.34      0.67      0.45       526\n\n    accuracy                           0.34      1783\n   macro avg       0.17      0.30      0.22      1783\nweighted avg       0.19      0.34      0.25      1783\n\nTraining model with filters=128, kernel_size=5, dropout_rate=0.2\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 710us/step\n\nClassification Report (CNN - tf-idf - Filters:128 Kernel:5 Dropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.35      0.47      0.40       480\n   Ramaphosa       0.75      0.01      0.01       456\n        Zuma       0.33      0.72      0.46       526\n\n    accuracy                           0.34      1783\n   macro avg       0.36      0.30      0.22      1783\nweighted avg       0.38      0.34      0.25      1783\n\nTraining model with filters=128, kernel_size=5, dropout_rate=0.5\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 766us/step\n\nClassification Report (CNN - tf-idf - Filters:128 Kernel:5 Dropout:0.5):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.34      0.50      0.40       480\n   Ramaphosa       1.00      0.00      0.00       456\n        Zuma       0.34      0.69      0.45       526\n\n    accuracy                           0.34      1783\n   macro avg       0.42      0.30      0.22      1783\nweighted avg       0.45      0.34      0.24      1783\n\nFilters: 64, Kernel Size: 3, Dropout Rate: 0.2, Best Val Accuracy: 0.3507295250892639\nFilters: 64, Kernel Size: 3, Dropout Rate: 0.5, Best Val Accuracy: 0.3473625183105469\nFilters: 128, Kernel Size: 3, Dropout Rate: 0.2, Best Val Accuracy: 0.3473625183105469\nFilters: 128, Kernel Size: 3, Dropout Rate: 0.5, Best Val Accuracy: 0.3468013405799866\nFilters: 64, Kernel Size: 5, Dropout Rate: 0.5, Best Val Accuracy: 0.34567901492118835\nFilters: 64, Kernel Size: 5, Dropout Rate: 0.2, Best Val Accuracy: 0.34455668926239014\nFilters: 128, Kernel Size: 5, Dropout Rate: 0.5, Best Val Accuracy: 0.34455668926239014\nFilters: 128, Kernel Size: 5, Dropout Rate: 0.2, Best Val Accuracy: 0.3428731858730316\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-3.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-4.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-5.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-6.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-7.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-8.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-9.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-10.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-11.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-12.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-13.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-14.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-15.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-16.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-17.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-20-output-18.png){width=572 height=460}\n:::\n:::\n\n\n::: {.cell execution_count=21}\n\n::: {.cell-output .cell-output-stdout}\n```\nTraining model with filters=64, kernel_size=3, dropout_rate=0.2\n\r 1/56 [..............................] - ETA: 3s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 714us/step\n\nClassification Report (CNN - Embedding - Filters:64 Kernel:3 Dropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.27      0.33      0.30       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.28      0.65      0.39       526\n\n    accuracy                           0.28      1783\n   macro avg       0.14      0.24      0.17      1783\nweighted avg       0.16      0.28      0.20      1783\n\nTraining model with filters=64, kernel_size=3, dropout_rate=0.5\n\r 1/56 [..............................] - ETA: 2s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 531us/step\n\nClassification Report (CNN - Embedding - Filters:64 Kernel:3 Dropout:0.5):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.27      0.20      0.23       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.29      0.77      0.42       526\n\n    accuracy                           0.28      1783\n   macro avg       0.14      0.24      0.16      1783\nweighted avg       0.16      0.28      0.18      1783\n\nTraining model with filters=64, kernel_size=5, dropout_rate=0.2\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 570us/step\n\nClassification Report (CNN - Embedding - Filters:64 Kernel:5 Dropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.28      0.31      0.29       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.28      0.66      0.39       526\n\n    accuracy                           0.28      1783\n   macro avg       0.14      0.24      0.17      1783\nweighted avg       0.16      0.28      0.20      1783\n\nTraining model with filters=64, kernel_size=5, dropout_rate=0.5\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 539us/step\n\nClassification Report (CNN - Embedding - Filters:64 Kernel:5 Dropout:0.5):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.18      0.04      0.06       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.29      0.93      0.44       526\n\n    accuracy                           0.28      1783\n   macro avg       0.12      0.24      0.13      1783\nweighted avg       0.13      0.28      0.15      1783\n\nTraining model with filters=128, kernel_size=3, dropout_rate=0.2\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 720us/step\n\nClassification Report (CNN - Embedding - Filters:128 Kernel:3 Dropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.28      0.29      0.28       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.28      0.69      0.40       526\n\n    accuracy                           0.28      1783\n   macro avg       0.14      0.24      0.17      1783\nweighted avg       0.16      0.28      0.19      1783\n\nTraining model with filters=128, kernel_size=3, dropout_rate=0.5\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 703us/step\n\nClassification Report (CNN - Embedding - Filters:128 Kernel:3 Dropout:0.5):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.28      0.30      0.29       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.28      0.67      0.39       526\n\n    accuracy                           0.28      1783\n   macro avg       0.14      0.24      0.17      1783\nweighted avg       0.16      0.28      0.19      1783\n\nTraining model with filters=128, kernel_size=5, dropout_rate=0.2\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 703us/step\n\nClassification Report (CNN - Embedding - Filters:128 Kernel:5 Dropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.28      0.29      0.28       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.28      0.68      0.39       526\n\n    accuracy                           0.28      1783\n   macro avg       0.14      0.24      0.17      1783\nweighted avg       0.16      0.28      0.19      1783\n\nTraining model with filters=128, kernel_size=5, dropout_rate=0.5\n\r 1/56 [..............................] - ETA: 1s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 700us/step\n\nClassification Report (CNN - Embedding - Filters:128 Kernel:5 Dropout:0.5):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.26      0.21      0.23       480\n   Ramaphosa       0.00      0.00      0.00       456\n        Zuma       0.28      0.75      0.41       526\n\n    accuracy                           0.28      1783\n   macro avg       0.14      0.24      0.16      1783\nweighted avg       0.15      0.28      0.18      1783\n\nFilters: 64, Kernel Size: 5, Dropout Rate: 0.2, Best Val Accuracy: 0.30695846676826477\nFilters: 64, Kernel Size: 3, Dropout Rate: 0.5, Best Val Accuracy: 0.30471381545066833\nFilters: 128, Kernel Size: 5, Dropout Rate: 0.5, Best Val Accuracy: 0.30471381545066833\nFilters: 128, Kernel Size: 3, Dropout Rate: 0.5, Best Val Accuracy: 0.30415263772010803\nFilters: 64, Kernel Size: 5, Dropout Rate: 0.5, Best Val Accuracy: 0.30359145998954773\nFilters: 128, Kernel Size: 5, Dropout Rate: 0.2, Best Val Accuracy: 0.30359145998954773\nFilters: 128, Kernel Size: 3, Dropout Rate: 0.2, Best Val Accuracy: 0.3024691343307495\nFilters: 64, Kernel Size: 3, Dropout Rate: 0.2, Best Val Accuracy: 0.3013468086719513\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-3.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-4.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-5.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-6.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-7.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-8.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-9.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-10.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-11.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-12.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-13.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-14.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-15.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-16.png){width=572 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-17.png){width=621 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-21-output-18.png){width=572 height=460}\n:::\n:::\n\n\n\n\n::: {.cell execution_count=23}\n\n::: {.cell-output .cell-output-stderr}\n```\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-23-output-2.png){width=682 height=460}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\r 1/56 [..............................] - ETA: 6s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 9/56 [===>..........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r17/56 [========>.....................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r24/56 [===========>..................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r32/56 [================>.............] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r40/56 [====================>.........] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r48/56 [========================>.....] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 7ms/step\n\nClassification Report (RNN - BoW - LSTM:50 SpatialDropout:0.0 Dropout:0.2 RecurrentDropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.41      0.34      0.37       480\n   Ramaphosa       0.64      0.02      0.03       456\n        Zuma       0.33      0.86      0.48       526\n\n    accuracy                           0.35      1783\n   macro avg       0.34      0.30      0.22      1783\nweighted avg       0.37      0.35      0.25      1783\n\n\r 1/56 [..............................] - ETA: 6s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 8/56 [===>..........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r16/56 [=======>......................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r24/56 [===========>..................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r32/56 [================>.............] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r40/56 [====================>.........] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r48/56 [========================>.....] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 7ms/step\n\nClassification Report (RNN - BoW - LSTM:50 SpatialDropout:0.2 Dropout:0.2 RecurrentDropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.56      0.03      0.06       480\n   Ramaphosa       0.43      0.01      0.03       456\n        Zuma       0.30      0.99      0.46       526\n\n    accuracy                           0.30      1783\n   macro avg       0.32      0.26      0.14      1783\nweighted avg       0.35      0.30      0.16      1783\n\n\r 1/56 [..............................] - ETA: 6s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 6/56 [==>...........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r12/56 [=====>........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/56 [========>.....................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r24/56 [===========>..................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r30/56 [===============>..............] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r36/56 [==================>...........] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r42/56 [=====================>........] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r48/56 [========================>.....] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r54/56 [===========================>..] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 1s 9ms/step\n\nClassification Report (RNN - BoW - LSTM:75 SpatialDropout:0.0 Dropout:0.2 RecurrentDropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.40      0.11      0.17       480\n   Ramaphosa       0.50      0.01      0.03       456\n        Zuma       0.31      0.95      0.46       526\n\n    accuracy                           0.31      1783\n   macro avg       0.30      0.27      0.17      1783\nweighted avg       0.33      0.31      0.19      1783\n\n\r 1/56 [..............................] - ETA: 6s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 6/56 [==>...........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r12/56 [=====>........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r18/56 [========>.....................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r24/56 [===========>..................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r30/56 [===============>..............] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r36/56 [==================>...........] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r42/56 [=====================>........] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r48/56 [========================>.....] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r54/56 [===========================>..] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 1s 9ms/step\n\nClassification Report (RNN - BoW - LSTM:75 SpatialDropout:0.2 Dropout:0.2 RecurrentDropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.45      0.08      0.14       480\n   Ramaphosa       0.43      0.01      0.03       456\n        Zuma       0.30      0.97      0.46       526\n\n    accuracy                           0.31      1783\n   macro avg       0.30      0.27      0.16      1783\nweighted avg       0.32      0.31      0.18      1783\n\nLSTM Units: 50, Spatial Dropout: 0.0, Dropout: 0.2, Recurrent Dropout: 0.2, Best Val Accuracy: 0.36251401901245117\nLSTM Units: 75, Spatial Dropout: 0.0, Dropout: 0.2, Recurrent Dropout: 0.2, Best Val Accuracy: 0.36139169335365295\nLSTM Units: 50, Spatial Dropout: 0.2, Dropout: 0.2, Recurrent Dropout: 0.2, Best Val Accuracy: 0.33782267570495605\nLSTM Units: 75, Spatial Dropout: 0.2, Dropout: 0.2, Recurrent Dropout: 0.2, Best Val Accuracy: 0.3322109878063202\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-23-output-4.png){width=689 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-23-output-5.png){width=682 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-23-output-6.png){width=689 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-23-output-7.png){width=682 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-23-output-8.png){width=689 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-23-output-9.png){width=693 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-23-output-10.png){width=689 height=460}\n:::\n:::\n\n\n::: {.cell execution_count=24}\n\n::: {.cell-output .cell-output-stderr}\n```\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\nWARNING:absl:At this time, the v2.11+ optimizer `tf.keras.optimizers.Adam` runs slowly on M1/M2 Macs, please use the legacy Keras optimizer instead, located at `tf.keras.optimizers.legacy.Adam`.\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n/Users/heiletjevanzyl/anaconda3/lib/python3.11/site-packages/sklearn/metrics/_classification.py:1469: UndefinedMetricWarning:\n\nPrecision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples. Use `zero_division` parameter to control this behavior.\n\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-24-output-2.png){width=691 height=460}\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n\r 1/56 [..............................] - ETA: 6s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 9/56 [===>..........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r17/56 [========>.....................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r25/56 [============>.................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r33/56 [================>.............] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r41/56 [====================>.........] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r49/56 [=========================>....] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 7ms/step\n\nClassification Report (RNN - tf-idf - LSTM:50 SpatialDropout:0.0 Dropout:0.2 RecurrentDropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.31      0.14      0.19       480\n   Ramaphosa       0.53      0.02      0.04       456\n        Zuma       0.30      0.88      0.45       526\n\n    accuracy                           0.30      1783\n   macro avg       0.28      0.26      0.17      1783\nweighted avg       0.31      0.30      0.19      1783\n\n\r 1/56 [..............................] - ETA: 6s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 8/56 [===>..........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r16/56 [=======>......................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r24/56 [===========>..................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r32/56 [================>.............] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r40/56 [====================>.........] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r47/56 [========================>.....] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r55/56 [============================>.] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 0s 7ms/step\n\nClassification Report (RNN - tf-idf - LSTM:50 SpatialDropout:0.2 Dropout:0.2 RecurrentDropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.31      0.13      0.19       480\n   Ramaphosa       0.52      0.02      0.05       456\n        Zuma       0.30      0.90      0.45       526\n\n    accuracy                           0.31      1783\n   macro avg       0.28      0.26      0.17      1783\nweighted avg       0.31      0.31      0.20      1783\n\n\r 1/56 [..............................] - ETA: 7s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 5/56 [=>............................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r11/56 [====>.........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r17/56 [========>.....................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r23/56 [===========>..................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r29/56 [==============>...............] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r35/56 [=================>............] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r41/56 [====================>.........] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r47/56 [========================>.....] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r53/56 [===========================>..] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r55/56 [============================>.] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 1s 11ms/step\n\nClassification Report (RNN - tf-idf - LSTM:75 SpatialDropout:0.0 Dropout:0.2 RecurrentDropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.33      0.19      0.24       480\n   Ramaphosa       0.62      0.04      0.07       456\n        Zuma       0.30      0.85      0.45       526\n\n    accuracy                           0.31      1783\n   macro avg       0.31      0.27      0.19      1783\nweighted avg       0.34      0.31      0.22      1783\n\n\r 1/56 [..............................] - ETA: 6s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r 7/56 [==>...........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r13/56 [=====>........................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r19/56 [=========>....................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r25/56 [============>.................] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r31/56 [===============>..............] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r37/56 [==================>...........] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r43/56 [======================>.......] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r49/56 [=========================>....] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r55/56 [============================>.] - ETA: 0s\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\b\r56/56 [==============================] - 1s 9ms/step\n\nClassification Report (RNN - tf-idf - LSTM:75 SpatialDropout:0.2 Dropout:0.2 RecurrentDropout:0.2):\n              precision    recall  f1-score   support\n\n     Mandela       0.00      0.00      0.00       321\n       Mbeki       0.31      0.14      0.19       480\n   Ramaphosa       0.60      0.05      0.09       456\n        Zuma       0.30      0.88      0.45       526\n\n    accuracy                           0.31      1783\n   macro avg       0.30      0.27      0.18      1783\nweighted avg       0.33      0.31      0.21      1783\n\nLSTM Units: 50, Spatial Dropout: 0.2, Dropout: 0.2, Recurrent Dropout: 0.2, Best Val Accuracy: 0.3395061790943146\nLSTM Units: 75, Spatial Dropout: 0.0, Dropout: 0.2, Recurrent Dropout: 0.2, Best Val Accuracy: 0.32154881954193115\nLSTM Units: 75, Spatial Dropout: 0.2, Dropout: 0.2, Recurrent Dropout: 0.2, Best Val Accuracy: 0.3153759837150574\nLSTM Units: 50, Spatial Dropout: 0.0, Dropout: 0.2, Recurrent Dropout: 0.2, Best Val Accuracy: 0.31425365805625916\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-24-output-4.png){width=686 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-24-output-5.png){width=681 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-24-output-6.png){width=686 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-24-output-7.png){width=691 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-24-output-8.png){width=686 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-24-output-9.png){width=691 height=460}\n:::\n\n::: {.cell-output .cell-output-display}\n![](pycode_files/figure-html/cell-24-output-10.png){width=686 height=460}\n:::\n:::\n\n\n\n\n<h5> Overall model performance </h5>\n\n\n<h4> Discussion and Conclusion </h4> \n<hr> \n\n\n<h4> References </h4> \n<hr> \n\n</div> \n\n",
    "supporting": [
      "pycode_files/figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}